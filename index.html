<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport"
        content="width=device-width,initial-scale=1,minimum-scale=1,viewport-fit=cover,shrink-to-fit=no">
    <title>Bill Rossman</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300..700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="snap-arrows">
        <div class="scroll-hint scroll-hint-desktop">
            <span>Scroll down to see more about me</span>
        </div>
        <button class="snap-arrow snap-arrow-up" type="button" aria-label="Previous section">
            <svg viewBox="0 0 24 24" aria-hidden="true">
                <path
                    d="M12 8.5c.26 0 .52.1.71.29l6 6-1.42 1.42L12 11.62 6.71 16.21 5.29 14.79l6-6c.19-.19.45-.29.71-.29Z" />
            </svg>
        </button>
        <button class="snap-arrow snap-arrow-down" type="button" aria-label="Next section">
            <svg viewBox="0 0 24 24" aria-hidden="true">
                <path
                    d="M12 15.5c-.26 0-.52-.1-.71-.29l-6-6 1.42-1.42L12 12.38l5.29-5.29 1.42 1.42-6 6c-.19.19-.45.29-.71.29Z" />
            </svg>
        </button>
    </div>

    <div class="main-view">
        <main class="shell snap-page main-snap">
            <section class="hero snap-section" id="hero">
                <h1 class="hero-greeting">
                    <span class="hero-greeting-prefix">hello, my name is</span>
                    <span class="hero-greeting-name">Bill Rossman</span>
                </h1>
                <div class="hero-text">
                    <div class="hero-title">
                        <div class="title-line">
                            <span class="title-prefix">I am a</span>
                            <div class="role-rotate plain">
                                <span class="role-word">system administrator</span>
                            </div>
                        </div>
                    </div>
                    <p class="lede">
                        Through eight years of experience in system administration, I have remained focused on
                        continuous
                        learning and efficiently resolving complex technical issues. I am motivated by solving real
                        problems, collaborating with other technical professionals, and making systems and workflows
                        measurably better.
                    </p>
                    <div class="hero-cta-row">
                        <a class="stat-card stat-card-link stat-card-current"
                            href="https://military.microsoft.com/mssa/" target="_blank" rel="noopener noreferrer">
                            <span class="stat-label">Currently</span>
                            <ul class="stat-list">
                                <li>
                                    <span class="stat-line-block">Participating in Microsoft's Military Transition
                                        program:</span>
                                    <span class="stat-line-block stat-accent">Microsoft Software &amp; Systems
                                        Academy (MSSA)</span>
                                </li>
                            </ul>
                        </a>
                        <button class="btn primary btn-tile js-show-projects" type="button">
                            <span class="btn-text">View<br>Projects</span>
                        </button>
                    </div>
                    <div class="scroll-hint">
                        <span>Scroll down to see more about me</span>
                        <svg viewBox="0 0 24 24" aria-hidden="true">
                            <path
                                d="M12 15.5c-.26 0-.52-.1-.71-.29l-6-6 1.42-1.42L12 12.38l5.29-5.29 1.42 1.42-6 6c-.19.19-.45.29-.71.29Z" />
                        </svg>
                    </div>
                </div>
                <div class="hero-visual">
                    <div class="portrait-frame">
                        <img src="data/photos/profile.jpg" alt="Bill Rossman" class="portrait">
                    </div>
                </div>
            </section>

            <section class="section snap-section" id="experience">
                <div class="section-head">
                    <h2 class="section-heading-large">Experience</h2>
                </div>
                <div class="timeline">
                    <article class="timeline-card">
                        <div class="edu-icon">
                            <img src="data/photos/navy.png" alt="US Navy icon">
                        </div>
                        <div class="timeline-header">
                            <h3>System Administrator, Lead</h3>
                            <span class="timeline-date">Nov 2022 - Dec 2025</span>
                        </div>
                        <div class="place-line">
                            <h4 class="place-heading">USS Sampson (DDG-102)</h4>
                            <span class="place-location">Everett, WA</span>
                        </div>
                        <div class="timeline-meta">
                            <span class="pill">Front-Line Manager</span>
                            <span class="pill">Maintenance Supervisor</span>
                        </div>
                    </article>
                    <article class="timeline-card">
                        <div class="edu-icon">
                            <img src="data/photos/navy.png" alt="US Navy icon">
                        </div>
                        <div class="timeline-header">
                            <h3>Junior System Administrator</h3>
                            <span class="timeline-date">Dec 2019 - Nov 2022</span>
                        </div>
                        <div class="place-line">
                            <h4 class="place-heading">USS Sampson (DDG-102)</h4>
                            <span class="place-location">Everett, WA</span>
                        </div>
                        <div class="timeline-meta">
                            <span class="pill">Procurement Specialist</span>
                        </div>
                    </article>
                    <article class="timeline-card">
                        <div class="edu-icon">
                            <img src="data/photos/mbit.png" alt="MBIT icon">
                        </div>
                        <div class="timeline-header">
                            <h3>Student System Administrator</h3>
                            <span class="timeline-date">Sep 2017 - Jul 2019</span>
                        </div>
                        <div class="place-line">
                            <h4 class="place-heading">Middle Bucks Institute of Technology</h4>
                            <span class="place-location">Jamison, PA</span>
                        </div>
                    </article>
                </div>
            </section>

            <section class="section snap-section" id="education">
                <div class="section-head">
                    <h2 class="section-heading-large">Education</h2>
                </div>
                <div class="timeline">
                    <article class="timeline-card">
                        <div class="edu-icon">
                            <img src="data/photos/microsoft.png" alt="Microsoft SSA icon">
                        </div>
                        <div class="timeline-header">
                            <h3>Cloud Application Development Program</h3>
                            <span class="timeline-date">Nov 2025 - Mar 2026</span>
                        </div>
                        <div class="place-line">
                            <h4 class="place-heading">Microsoft Software and Systems Academy</h4>
                            <span class="place-location">Remote</span>
                        </div>
                        <p class="edu-desc">Hands-on training in building, deploying, and securing cloud-native
                            applications. Focus on modern development frameworks, DevOps practices, and Microsoft Azure
                            services.</p>
                    </article>
                    <article class="timeline-card">
                        <div class="edu-icon">
                            <img src="data/photos/mbit.png" alt="MBIT icon">
                        </div>
                        <div class="timeline-header">
                            <h3>Network Operating Systems and Security</h3>
                            <span class="timeline-date">Sep 2016 - Jun 2019</span>
                        </div>
                        <div class="place-line">
                            <h4 class="place-heading">Middle Bucks Institute of Technology</h4>
                            <span class="place-location">Jamison, PA</span>
                        </div>
                        <p class="edu-desc">Three-year vocational program structured around CompTIA's A+, Network+, and
                            Security+ core objectives.</p>
                    </article>
                </div>
            </section>

            <section class="section snap-section stacked" id="certifications">
                <div class="subsection-head">
                    <h3 class="section-heading-large">Clearance</h3>
                </div>
                <div class="badge-grid">
                    <div class="badge-card badge-wide">
                        <div class="badge-thumb accent">TS/SCI</div>
                        <div>
                            <h4>Top Secret / SCI Clearance</h4>
                            <p class="muted">CI Polygraph (Adjudicated May 2020)</p>
                        </div>
                    </div>
                </div>
                <div class="subsection-head">
                    <h3 class="section-heading-large">Certifications</h3>
                </div>
                <div class="badge-grid">
                    <div class="badge-card">
                        <img src="data/certbadges/security.png" alt="CompTIA Security+" class="badge-thumb">
                        <div>
                            <h4>Security+</h4>
                            <p class="muted">CompTIA</p>
                        </div>
                    </div>
                    <div class="badge-card">
                        <img src="data/certbadges/network.png" alt="CompTIA Network+" class="badge-thumb">
                        <div>
                            <h4>Network+</h4>
                            <p class="muted">CompTIA</p>
                        </div>
                    </div>
                    <div class="badge-card">
                        <img src="data/certbadges/cloud.png" alt="CompTIA Cloud+" class="badge-thumb">
                        <div>
                            <h4>Cloud+</h4>
                            <p class="muted">CompTIA</p>
                        </div>
                    </div>
                    <div class="badge-card">
                        <img src="data/certbadges/rhcsa.png" alt="Red Hat Certified System Administrator"
                            class="badge-thumb">
                        <div>
                            <h4>Red Hat Certified System Administrator</h4>
                            <p class="muted">Red Hat</p>
                        </div>
                    </div>
                </div>
            </section>

            <section class="section snap-section" id="skills">
                <div class="section-head">
                    <h2>Skills</h2>
                </div>
                <div class="spacer-vertical"></div>
                <div class="skill-group">
                    <span class="skill-label">Languages</span>
                    <div class="pill-cloud">
                        <span class="pill solid">C#</span>
                        <span class="pill solid">PowerShell</span>
                    </div>
                </div>
                <div class="skill-group">
                    <span class="skill-label">Frameworks / Technologies</span>
                    <div class="pill-cloud">
                        <span class="pill solid">.NET</span>
                        <span class="pill solid">ASP.NET Core</span>
                        <span class="pill solid">Entity Framework Core</span>
                        <span class="pill solid">Git</span>
                    </div>
                </div>
                <div class="skill-group">
                    <span class="skill-label">Cloud</span>
                    <div class="pill-cloud">
                        <span class="pill solid">Azure App Service</span>
                        <span class="pill solid">Azure SQL</span>
                        <span class="pill solid">Azure Blob Storage</span>
                        <span class="pill solid">AWS Elastic Beanstalk</span>
                        <span class="pill solid">AWS RDS</span>
                        <span class="pill solid">AWS S3</span>
                    </div>
                </div>
                <div class="skill-group">
                    <span class="skill-label">Systems Knowledge</span>
                    <div class="pill-cloud">
                        <span class="pill solid">Linux</span>
                        <span class="pill solid">TCP/IP</span>
                        <span class="pill solid">Virtualization</span>
                        <span class="pill solid">System monitoring</span>
                        <span class="pill solid">Fault isolation</span>
                    </div>
                </div>
            </section>

            <section class="section snap-section stacked" id="contact">
                <div class="section-head">
                    <h2 class="section-heading-large">Contact</h2>
                </div>
                <div class="contact-grid">
                    <a href="mailto:william.m.rossman@gmail.com" class="contact-card">
                        <div class="contact-icon">
                            <svg viewBox="0 0 24 24" aria-hidden="true">
                                <path
                                    d="M3.5 5h17a1.5 1.5 0 0 1 1.5 1.5v11A1.5 1.5 0 0 1 20.5 19h-17A1.5 1.5 0 0 1 2 17.5v-11A1.5 1.5 0 0 1 3.5 5zm.25 2L12 12.35 20.25 7h-16.5zm16.75 1.4-6.86 4.2a2 2 0 0 1-2.08 0L4 8.4V17h16.5V8.4z" />
                            </svg>
                        </div>
                        <div class="contact-body">
                            <span class="contact-label">Email</span>
                            <span class="contact-value">william.m.rossman@gmail.com</span>
                        </div>
                    </a>
                    <a href="https://www.linkedin.com/in/wmrossman/" class="contact-card" target="_blank"
                        rel="noopener noreferrer">
                        <div class="contact-icon">
                            <svg viewBox="0 0 24 24" aria-hidden="true">
                                <path
                                    d="M5.5 9h3v10h-3V9zm1.5-5a1.75 1.75 0 1 1 0 3.5 1.75 1.75 0 0 1 0-3.5zM10.5 9h2.8v1.4h.04c.39-.74 1.36-1.52 2.8-1.52 3 0 3.56 1.97 3.56 4.53V19h-3v-4.8c0-1.14-.02-2.6-1.58-2.6-1.58 0-1.82 1.24-1.82 2.52V19h-3V9z" />
                            </svg>
                        </div>
                        <div class="contact-body">
                            <span class="contact-label">LinkedIn</span>
                            <span class="contact-value">wmrossman</span>
                        </div>
                    </a>
                    <a href="https://github.com/wrossman" class="contact-card" target="_blank"
                        rel="noopener noreferrer">
                        <div class="contact-icon">
                            <svg viewBox="0 0 24 24" aria-hidden="true">
                                <path
                                    d="M12 2a10 10 0 0 0-3.16 19.49c.5.09.68-.22.68-.48v-1.69c-2.78.6-3.37-1.34-3.37-1.34-.45-1.14-1.1-1.44-1.1-1.44-.9-.62.07-.61.07-.61 1 .07 1.54 1.03 1.54 1.03.89 1.53 2.34 1.09 2.9.83.09-.64.35-1.08.63-1.33-2.22-.25-4.56-1.11-4.56-4.94 0-1.09.39-1.98 1.03-2.68-.1-.25-.45-1.26.1-2.63 0 0 .84-.27 2.75 1.02A9.56 9.56 0 0 1 12 6.8a9.6 9.6 0 0 1 2.5.34c1.9-1.29 2.74-1.02 2.74-1.02.56 1.37.21 2.38.1 2.63.64.7 1.03 1.59 1.03 2.68 0 3.84-2.34 4.68-4.57 4.93.36.31.68.92.68 1.85v2.74c0 .27.18.58.69.48A10 10 0 0 0 12 2z" />
                            </svg>
                        </div>
                        <div class="contact-body">
                            <span class="contact-label">GitHub</span>
                            <span class="contact-value">wrossman</span>
                        </div>
                    </a>
                </div>
                <a class="btn primary back-to-top" href="#hero">Back to top</a>
            </section>
        </main>
    </div>

    <div class="projects-view" aria-hidden="true">
        <a class="pill tone back-pill projects-back js-hide-projects" href="#hero">
            <span aria-hidden="true">&lt;</span>
            <span>Back to Bio</span>
        </a>
        <h1 class="projects-fixed-title">Projects</h1>
        <div class="projects-scroll-hint">
            <span class="hint-scroll">Scroll to see the projects</span>
            <span class="hint-swipe">Swipe to see the projects</span>
        </div>

        <main class="snap-page projects-snap">
            <div class="projects-deck" aria-hidden="false"></div>
            <section class="section snap-section project-section" data-project-index="0" id="project-1">
                <article class="timeline-card">
                    <div class="project-header">
                        <span class="pill tone">Signal Reporting Tool</span>
                    </div>
                    <h3>Automated Daily Reporting for Shipboard Signal Collection</h3>
                    <div class="tech-stack">
                        <span class="tech-item">PowerShell</span>
                        <span class="tech-item">Oracle DB</span>
                    </div>
                    <ul>
                        <li>Developed a PowerShell program that retrieved inputs from Oracle DB and internal web sources
                            to
                            generate daily operational reports for system operators.</li>
                        <li>Implemented a modular, template-driven formatting system to support multiple AOR reporting
                            standards.</li>
                        <li>Delivered full how-to documentation, example report templates, and hands-on training to
                            refine
                            workflows and eliminate repetitive tasks.</li>
                        <li>Reduced operator reporting workload by one hour per day while improving accuracy and
                            enforcing
                            consistent formatting.</li>
                    </ul>
                </article>
            </section>

            <section class="section snap-section project-section" data-project-index="1" id="project-2">
                <article class="timeline-card" data-project-link="https://github.com/wrossman/LightSaver-Web-App">
                    <div class="project-header">
                        <span class="pill tone">LightSaver</span>
                    </div>
                    <h3>Photo Stream App for Roku TV</h3>
                    <div class="tech-stack">
                        <span class="tech-item">C#</span>
                        <span class="tech-item">ASP.NET Core</span>
                        <span class="tech-item">Roku SceneGraph</span>
                    </div>
                    <ul>
                        <li>Designed and built an ASP.NET Core web app and Roku client to overcome photo limits and
                            manual
                            upload constraints in Roku's default screensaver.</li>
                        <li>Integrated multiple image sources, including Adobe Lightroom, Google Photos, and direct
                            device
                            uploads.</li>
                        <li>Deployed to Azure and AWS development environments to validate cross-cloud portability and
                            gain
                            hands-on experience with multiple vendors.</li>
                        <li>First major side project, with plans to harden and release to production.</li>
                    </ul>
                </article>
            </section>

            <section class="section snap-section project-section" data-project-index="2" id="project-3">
                <article class="timeline-card" data-project-link="https://github.com/wrossman/MSSA_Projects">
                    <div class="project-header">
                        <span class="pill tone">MSSA Projects</span>
                    </div>
                    <h3>Training Portfolio from Microsoft Software and Systems Academy</h3>
                    <div class="tech-stack">
                        <span class="tech-item">C#</span>
                        <span class="tech-item">.NET</span>
                        <span class="tech-item">Azure OpenAI</span>
                    </div>
                    <ul>
                        <li>Built a collection of console apps and exercises covering loops, conditionals, and string
                            handling.</li>
                        <li>Implemented OOP interface demos that cycle through gadgets and trigger behaviors.</li>
                        <li>Created a mortgage calculator with shared logic and tests for verification.</li>
                        <li>Experimented with Azure OpenAI chat prompts and text-to-speech output using user secrets.
                        </li>
                    </ul>
                </article>
            </section>
        </main>
        <div class="link-preview" aria-hidden="true">
            <span class="link-preview-label">Project link:</span>
            <a class="link-preview-url" href="#" target="_blank" rel="noopener noreferrer"></a>
        </div>
    </div>

    <script>
        (function () {
            const roles = [
                "system administrator",
                "developer",
                "veteran",
                "problem solver",
                "learner",
                "photographer",
                "rock climber"
            ];
            const el = document.querySelector(".role-word");
            if (!el) return;
            let i = 0;
            setInterval(() => {
                el.classList.add("fade-out");
                setTimeout(() => {
                    i = (i + 1) % roles.length;
                    el.textContent = roles[i];
                    el.classList.remove("fade-out");
                }, 250);
            }, 2100);
        })();
        (function () {
            const container = document.querySelector(".main-view .snap-page");
            const sections = Array.from(container?.querySelectorAll(".snap-section") || []);
            const body = document.body;
            const up = document.querySelector(".snap-arrow-up");
            const down = document.querySelector(".snap-arrow-down");
            const hintDesktop = document.querySelector(".scroll-hint-desktop");
            const hero = document.querySelector(".hero");
            const greeting = document.querySelector(".hero-greeting");
            const titleLine = document.querySelector(".hero .title-line");
            if (!container || !sections.length || !up || !down) return;
            let currentIndex = 0;

            const scrollToIndex = (idx) => {
                const clamped = Math.max(0, Math.min(idx, sections.length - 1));
                sections[clamped].scrollIntoView({ behavior: "smooth", block: "center" });
            };

            const updateArrows = () => {
                if (document.body.classList.contains("projects-page")) return;
                if (currentIndex <= 0) {
                    up.classList.add("is-hidden");
                } else {
                    up.classList.remove("is-hidden");
                }
                if (currentIndex >= sections.length - 1) {
                    down.classList.add("is-hidden");
                } else {
                    down.classList.remove("is-hidden");
                }
                if (hintDesktop) {
                    hintDesktop.classList.toggle("is-hidden", currentIndex !== 0);
                }
            };

            const isDesktopLayout = () => window.matchMedia("(min-width: 1101px)").matches;

            const isSectionOverflowing = () => {
                const viewportHeight = window.innerHeight;
                return sections.some((section) => {
                    const scrollHeight = Math.ceil(section.scrollHeight);
                    const clientHeight = Math.ceil(section.clientHeight);
                    return scrollHeight > clientHeight + 1 || scrollHeight > viewportHeight + 1;
                });
            };

            const isGreetingClipped = () => {
                if (!hero || !greeting || !titleLine) return false;
                const titleRect = titleLine.getBoundingClientRect();
                const greetingRect = greeting.getBoundingClientRect();
                return greetingRect.bottom + 8 > titleRect.top;
            };

            const updateHeightMode = () => {
                if (body.classList.contains("projects-page")) return;
                const forceMobile = isSectionOverflowing() || isGreetingClipped();
                body.classList.toggle("force-mobile", forceMobile);
            };

            const updateGreetingPosition = () => {
                if (!hero || !greeting || !titleLine) return;
                if (!isDesktopLayout() || body.classList.contains("force-mobile")) {
                    hero.style.removeProperty("--hero-greeting-top");
                    return;
                }
                const heroRect = hero.getBoundingClientRect();
                const titleRect = titleLine.getBoundingClientRect();
                const greetingRect = greeting.getBoundingClientRect();
                const targetCenter = titleRect.top / 2;
                const maxTop = titleRect.top - heroRect.top - greetingRect.height - 8;
                let top = targetCenter - heroRect.top - greetingRect.height / 2;
                if (Number.isFinite(maxTop)) {
                    top = Math.min(top, maxTop);
                }
                top = Math.max(0, top);
                hero.style.setProperty("--hero-greeting-top", `${Math.round(top)}px`);
            };

            const syncLayout = () => {
                updateGreetingPosition();
                updateHeightMode();
                updateGreetingPosition();
            };

            up.addEventListener("click", () => scrollToIndex(currentIndex - 1));
            down.addEventListener("click", () => scrollToIndex(currentIndex + 1));

            let wheelCooldown = false;
            container.addEventListener(
                "wheel",
                (e) => {
                    if (document.body.classList.contains("projects-page")) return;
                    if (wheelCooldown) return;
                    if (Math.abs(e.deltaY) < 60) return;
                    e.preventDefault();
                    const direction = e.deltaY > 0 ? 1 : -1;
                    scrollToIndex(currentIndex + direction);
                    wheelCooldown = true;
                    setTimeout(() => (wheelCooldown = false), 180);
                },
                { passive: false }
            );

            const observer = new IntersectionObserver((entries) => {
                entries.forEach((entry) => {
                    if (entry.isIntersecting) {
                        if (document.body.classList.contains("projects-page")) return;
                        currentIndex = sections.indexOf(entry.target);
                        updateArrows();
                    }
                });
            }, { root: container, threshold: 0.6 });

            sections.forEach((section) => observer.observe(section));
            updateArrows();
            syncLayout();
            window.addEventListener("resize", () => requestAnimationFrame(syncLayout));
            document.fonts?.ready?.then(() => syncLayout());

        })();

        (function () {
            const body = document.body;
            const mainView = document.querySelector(".main-view");
            const projectsView = document.querySelector(".projects-view");
            const showProjects = document.querySelector(".js-show-projects");
            const hideProjects = document.querySelector(".js-hide-projects");
            if (!mainView || !projectsView || !showProjects || !hideProjects) return;

            const setProjectsVisible = (isVisible) => {
                body.classList.toggle("projects-page", isVisible);
                mainView.setAttribute("aria-hidden", String(isVisible));
                projectsView.setAttribute("aria-hidden", String(!isVisible));
                window.dispatchEvent(new Event("projects:layout"));
            };

            showProjects.addEventListener("click", (event) => {
                event.preventDefault();
                setProjectsVisible(true);
            });

            hideProjects.addEventListener("click", (event) => {
                event.preventDefault();
                setProjectsVisible(false);
                document.querySelector("#hero")?.scrollIntoView({ behavior: "smooth", block: "center" });
            });

            const container = projectsView.querySelector(".projects-snap");
            const sections = Array.from(projectsView.querySelectorAll(".project-section") || []);
            const deck = projectsView.querySelector(".projects-deck");
            const title = projectsView.querySelector(".projects-fixed-title");
            const linkPreview = projectsView.querySelector(".link-preview");
            const linkPreviewUrl = linkPreview?.querySelector(".link-preview-url");
            const linkPreviewLabel = linkPreview?.querySelector(".link-preview-label");
            if (!container || !sections.length || !deck) return;

            const isMobileList = window.matchMedia("(max-width: 720px)").matches;
            const total = sections.length;
            let virtualIndex = 0;
            let currentIndex = 0;
            const deckCards = [];
            let suppressDeckClick = false;
            let pointerStartX = 0;
            let pointerStartY = 0;
            let pointerActive = false;
            let pointerDownCard = null;
            let highlightTimeout = null;
            let lastCurrentIndex = null;
            let hoverHandlerCard = null;
            let hoverHandler = null;
            let clickNavTarget = null;
            let linkPreviewAnchor = null;
            let linkPreviewClearTimeout = null;
            const LINK_PREVIEW_FADE_MS = 220;
            let linkPreviewSwapTimeout = null;

            sections.forEach((section, index) => {
                const card = section.querySelector(".timeline-card");
                if (!card) return;
                const clone = card.cloneNode(true);
                clone.classList.add("deck-card");
                clone.dataset.deckIndex = index;
                if (card.dataset.projectLink) {
                    clone.dataset.projectLink = card.dataset.projectLink;
                }
                clone.addEventListener("mouseenter", () => {
                    if (!clone.classList.contains("is-current")) return;
                    if (clone.classList.contains("hover-blocked")) return;
                    if (!clone.classList.contains("is-in-view")) return;
                    clone.classList.add("is-ready");
                });
                clone.addEventListener("mouseleave", () => {
                    if (!clone.classList.contains("is-current")) return;
                    clone.classList.remove("hover-blocked");
                });
                deckCards.push(clone);
                deck.appendChild(clone);

                if (card.dataset.projectLink) {
                    const showPreview = () => {
                        if (!isProjectsActive() || !isProjectsListMode()) return;
                        setLinkPreview(card.dataset.projectLink, card);
                    };
                    const hidePreview = () => {
                        if (!isProjectsActive() || !isProjectsListMode()) return;
                        setLinkPreview("");
                    };
                    card.addEventListener("mouseenter", showPreview);
                    card.addEventListener("mouseleave", hidePreview);
                    card.addEventListener("focusin", showPreview);
                    card.addEventListener("focusout", hidePreview);
                }
            });

            const normalizeIndex = (idx) => ((idx % total) + total) % total;

            const setIndex = (nextIndex) => {
                virtualIndex = nextIndex;
                currentIndex = normalizeIndex(virtualIndex);
                updateDeck();
                updateTitle();
                updateProjectsHeightMode();
                syncLinkPreview();
            };

            const updateDeck = () => {
                const prevIndex = (currentIndex - 1 + total) % total;
                const nextIndex = (currentIndex + 1) % total;
                const prev2Index = (currentIndex - 2 + total) % total;
                const next2Index = (currentIndex + 2) % total;
                deckCards.forEach((card, i) => {
                    card.classList.remove("is-current", "is-prev", "is-next", "is-prev2", "is-next2", "is-far");
                    let offset = i - currentIndex;
                    if (offset > total / 2) offset -= total;
                    if (offset < -total / 2) offset += total;
                    const absOffset = Math.abs(offset);
                    card.style.zIndex = 100 - absOffset;
                    if (i === currentIndex) {
                        card.classList.add("is-current");
                    } else if (i === prevIndex) {
                        card.classList.add("is-prev");
                    } else if (i === nextIndex) {
                        card.classList.add("is-next");
                    } else if (i === prev2Index) {
                        card.classList.add("is-prev2");
                    } else if (i === next2Index) {
                        card.classList.add("is-next2");
                    } else {
                        card.classList.add("is-far");
                    }
                });

                if (currentIndex !== lastCurrentIndex) {
                    if (highlightTimeout) {
                        clearTimeout(highlightTimeout);
                        highlightTimeout = null;
                    }
                    if (hoverHandlerCard && hoverHandler) {
                        hoverHandlerCard.removeEventListener("transitionend", hoverHandler);
                        hoverHandlerCard = null;
                        hoverHandler = null;
                    }
                    const isClickNav = clickNavTarget === currentIndex;
                    clickNavTarget = null;
                    deckCards.forEach((card) => card.classList.remove("is-ready", "is-in-view", "hover-blocked"));
                    const currentCard = deckCards[currentIndex];
                    if (currentCard) {
                        if (isClickNav) {
                            currentCard.classList.add("hover-blocked");
                        }
                        hoverHandlerCard = currentCard;
                        hoverHandler = (event) => {
                            if (event.propertyName !== "transform") return;
                            if (deckCards[currentIndex] !== currentCard) return;
                            currentCard.classList.add("is-in-view");
                            if (!currentCard.classList.contains("hover-blocked")) {
                                currentCard.classList.add("is-ready");
                            }
                            syncLinkPreview();
                            if (hoverHandlerCard && hoverHandler) {
                                hoverHandlerCard.removeEventListener("transitionend", hoverHandler);
                            }
                            hoverHandlerCard = null;
                            hoverHandler = null;
                            if (highlightTimeout) {
                                clearTimeout(highlightTimeout);
                                highlightTimeout = null;
                            }
                        };
                        currentCard.addEventListener("transitionend", hoverHandler);
                        highlightTimeout = setTimeout(() => {
                            if (deckCards[currentIndex] === currentCard) {
                                currentCard.classList.add("is-in-view");
                                if (!currentCard.classList.contains("hover-blocked")) {
                                    currentCard.classList.add("is-ready");
                                }
                                syncLinkPreview();
                            }
                            if (hoverHandlerCard && hoverHandler) {
                                hoverHandlerCard.removeEventListener("transitionend", hoverHandler);
                            }
                            hoverHandlerCard = null;
                            hoverHandler = null;
                            highlightTimeout = null;
                        }, 320);
                    }
                    lastCurrentIndex = currentIndex;
                }
            };

            const updateTitle = () => {
                if (!title) return;
                if (body.classList.contains("projects-force-mobile")) {
                    title.style.removeProperty("top");
                    return;
                }
                const offset = Math.max(18, window.innerHeight * 0.18);
                title.style.top = `${offset}px`;
            };

            const getProjectLink = (cardEl) => {
                if (!cardEl) return "";
                if (cardEl.dataset.projectLink) return cardEl.dataset.projectLink;
                const idx = Number(cardEl.dataset.deckIndex);
                if (Number.isNaN(idx)) return "";
                const sourceCard = sections[idx]?.querySelector(".timeline-card");
                return sourceCard?.dataset.projectLink || "";
            };

            const openProjectLink = (link) => {
                if (!link) return;
                window.open(link, "_blank", "noopener,noreferrer");
            };

            const updateLinkPreviewPosition = (anchorEl) => {
                if (!linkPreview || !anchorEl) return;
                if (linkPreview.classList.contains("is-hiding")) return;
                const anchorRect = anchorEl.getBoundingClientRect();
                const previewRect = linkPreview.getBoundingClientRect();
                const viewHeight = window.innerHeight;
                const minTop = anchorRect.bottom + 8;
                const maxTop = viewHeight - previewRect.height - 8;
                let targetTop = (anchorRect.bottom + viewHeight) / 2 - previewRect.height / 2;
                if (maxTop < minTop) {
                    targetTop = Math.max(8, maxTop);
                } else {
                    targetTop = Math.max(minTop, Math.min(targetTop, maxTop));
                }
                linkPreview.style.setProperty("--link-preview-top", `${Math.round(targetTop)}px`);
                linkPreview.style.setProperty("--link-preview-bottom", "auto");
            };

            const setLinkPreview = (link, anchorEl) => {
                if (!linkPreview || !linkPreviewUrl) return;
                if (!link) {
                    if (linkPreviewClearTimeout) {
                        clearTimeout(linkPreviewClearTimeout);
                        linkPreviewClearTimeout = null;
                    }
                    if (linkPreviewSwapTimeout) {
                        clearTimeout(linkPreviewSwapTimeout);
                        linkPreviewSwapTimeout = null;
                    }
                    const wasVisible = linkPreview.classList.contains("is-visible");
                    linkPreview.classList.remove("is-visible");
                    linkPreview.classList.add("is-hiding");
                    linkPreview.setAttribute("aria-hidden", "true");
                    const clearPreview = () => {
                        if (linkPreviewLabel) {
                            linkPreviewLabel.textContent = "";
                        }
                        linkPreviewUrl.textContent = "";
                        linkPreviewUrl.removeAttribute("href");
                        linkPreviewUrl.removeAttribute("title");
                        linkPreviewAnchor = null;
                        linkPreview.classList.remove("is-hiding");
                    };
                    if (wasVisible) {
                        linkPreviewClearTimeout = setTimeout(clearPreview, LINK_PREVIEW_FADE_MS);
                    } else {
                        clearPreview();
                    }
                    return;
                }
                if (linkPreviewClearTimeout) {
                    clearTimeout(linkPreviewClearTimeout);
                    linkPreviewClearTimeout = null;
                }
                if (linkPreviewSwapTimeout) {
                    clearTimeout(linkPreviewSwapTimeout);
                    linkPreviewSwapTimeout = null;
                }
                const currentLink = linkPreviewUrl.textContent;
                const isVisible = linkPreview.classList.contains("is-visible");
                if (isVisible && currentLink && currentLink !== link) {
                    linkPreview.classList.remove("is-visible");
                    linkPreview.classList.add("is-hiding");
                    linkPreview.setAttribute("aria-hidden", "true");
                    if (anchorEl) {
                        linkPreviewAnchor = anchorEl;
                    }
                    linkPreviewSwapTimeout = setTimeout(() => {
                        linkPreview.classList.remove("is-hiding");
                        if (linkPreviewLabel) {
                            linkPreviewLabel.textContent = "Project link:";
                        }
                        linkPreviewUrl.textContent = link;
                        linkPreviewUrl.setAttribute("href", link);
                        linkPreviewUrl.setAttribute("title", link);
                        updateLinkPreviewPosition(linkPreviewAnchor);
                        linkPreview.classList.add("is-visible");
                        linkPreview.setAttribute("aria-hidden", "false");
                        linkPreviewSwapTimeout = null;
                    }, LINK_PREVIEW_FADE_MS);
                    return;
                }
                linkPreview.classList.remove("is-hiding");
                if (anchorEl) {
                    linkPreviewAnchor = anchorEl;
                }
                if (linkPreviewLabel) {
                    linkPreviewLabel.textContent = "Project link:";
                }
                linkPreviewUrl.textContent = link;
                linkPreviewUrl.setAttribute("href", link);
                linkPreviewUrl.setAttribute("title", link);
                updateLinkPreviewPosition(linkPreviewAnchor);
                linkPreview.classList.add("is-visible");
                linkPreview.setAttribute("aria-hidden", "false");
            };

            const isProjectsActive = () => body.classList.contains("projects-page");
            const isProjectsMobile = () =>
                isMobileList || body.classList.contains("projects-force-mobile");
            const isProjectsListMode = () =>
                isProjectsMobile() ||
                window.matchMedia("(max-height: 880px) and (min-width: 721px)").matches;

            const syncLinkPreview = () => {
                if (!isProjectsActive()) {
                    setLinkPreview("");
                    return;
                }
                if (isProjectsListMode()) {
                    if (linkPreviewAnchor && linkPreviewAnchor.matches(":hover")) {
                        updateLinkPreviewPosition(linkPreviewAnchor);
                        return;
                    }
                    setLinkPreview("");
                    return;
                }
                const currentCard = deckCards[currentIndex];
                if (!currentCard) {
                    return;
                }
                if (!currentCard.classList.contains("is-in-view")) {
                    return;
                }
                const link = getProjectLink(currentCard);
                setLinkPreview(link, currentCard);
            };

            const updateProjectsHeightMode = () => {
                if (!isProjectsActive()) {
                    body.classList.remove("projects-force-mobile");
                    syncLinkPreview();
                    return;
                }
                if (isMobileList) {
                    body.classList.add("projects-force-mobile");
                    updateTitle();
                    syncLinkPreview();
                    return;
                }
                const wasForced = body.classList.contains("projects-force-mobile");
                if (wasForced) {
                    body.classList.remove("projects-force-mobile");
                    updateTitle();
                }
                const currentCard = deckCards[currentIndex];
                if (!title || !currentCard) {
                    syncLinkPreview();
                    return;
                }
                const titleRect = title.getBoundingClientRect();
                const cardRect = currentCard.getBoundingClientRect();
                const overlapTop = titleRect.bottom + 16 >= cardRect.top;
                const clippedBottom = cardRect.bottom > window.innerHeight - 16;
                const tooTall = cardRect.height > window.innerHeight - 80;
                const heightTooShort = window.innerHeight < 880;
                const forceMobile =
                    heightTooShort || overlapTop || clippedBottom || tooTall || window.innerHeight < 560;
                body.classList.toggle("projects-force-mobile", forceMobile);
                if (wasForced !== forceMobile) {
                    updateTitle();
                }
                syncLinkPreview();
            };

            projectsView.addEventListener("click", (event) => {
                if (!isProjectsActive() || !isProjectsListMode()) return;
                const card = event.target.closest(".project-section .timeline-card");
                if (!card) return;
                const link = card.dataset.projectLink;
                if (!link) return;
                event.preventDefault();
                openProjectLink(link);
            });

            let wheelCooldown = false;
            container.addEventListener(
                "wheel",
                (event) => {
                    if (!isProjectsActive() || isProjectsMobile()) return;
                    if (wheelCooldown) return;
                    const absX = Math.abs(event.deltaX);
                    const absY = Math.abs(event.deltaY);
                    const axisDelta = absX > absY ? event.deltaX : event.deltaY;
                    if (Math.abs(axisDelta) < 60) return;
                    event.preventDefault();
                    const direction = axisDelta > 0 ? 1 : -1;
                    setIndex(virtualIndex + direction);
                    wheelCooldown = true;
                    setTimeout(() => (wheelCooldown = false), 180);
                },
                { passive: false }
            );

            container.addEventListener("pointerdown", (event) => {
                if (!isProjectsActive() || isProjectsMobile()) return;
                if (event.pointerType === "mouse" && event.button !== 0) return;
                pointerActive = true;
                pointerStartX = event.clientX;
                pointerStartY = event.clientY;
                pointerDownCard = event.target.closest(".deck-card");
                suppressDeckClick = false;
                if (event.pointerType !== "mouse") {
                    container.setPointerCapture(event.pointerId);
                }
            });

            const finishPointer = (event) => {
                if (!pointerActive) return;
                pointerActive = false;
                const deltaX = event.clientX - pointerStartX;
                const deltaY = event.clientY - pointerStartY;
                const absX = Math.abs(deltaX);
                const absY = Math.abs(deltaY);
                if (absX >= 50 && absX >= absY) {
                    const direction = deltaX < 0 ? 1 : -1;
                    setIndex(virtualIndex + direction);
                    suppressDeckClick = true;
                    pointerDownCard = null;
                    return;
                }
                if (!pointerDownCard) return;
                const idx = Number(pointerDownCard.dataset.deckIndex);
                if (Number.isNaN(idx)) return;
                const projectLink = getProjectLink(pointerDownCard);
                if (pointerDownCard.classList.contains("is-current") && projectLink) {
                    openProjectLink(projectLink);
                    suppressDeckClick = true;
                    pointerDownCard = null;
                    return;
                }
                clickNavTarget = idx;
                setIndex(virtualIndex + (idx - currentIndex));
                suppressDeckClick = true;
                pointerDownCard = null;
            };

            container.addEventListener("pointerup", finishPointer);
            container.addEventListener("pointercancel", finishPointer);

            deck.addEventListener("click", (event) => {
                if (!isProjectsActive() || isProjectsMobile()) return;
                if (suppressDeckClick) {
                    suppressDeckClick = false;
                    return;
                }
                const card = event.target.closest(".deck-card");
                if (!card) return;
                const projectLink = getProjectLink(card);
                if (card.classList.contains("is-current") && projectLink) {
                    event.preventDefault();
                    openProjectLink(projectLink);
                    return;
                }
                const idx = Number(card.dataset.deckIndex);
                if (Number.isNaN(idx)) return;
                const delta = idx - currentIndex;
                clickNavTarget = idx;
                setIndex(virtualIndex + delta);
            });

            setIndex(0);
            updateTitle();
            updateProjectsHeightMode();
            window.addEventListener("resize", updateTitle);
            window.addEventListener("resize", updateProjectsHeightMode);
            window.addEventListener("projects:layout", () => {
                updateTitle();
                updateProjectsHeightMode();
            });
        })();
    </script>
</body>

</html>
